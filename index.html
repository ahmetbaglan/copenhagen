<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Social Data &amp; Visualizations Project</title>
  <script type="text/javascript" src="d3.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600">
  <link rel="stylesheet" type="text/css" href="sequences.css" />
</head>

<body>
  <div class="header">
    <h1>Copenhagen in Demographics &amp; Politics</h1>
    <i>An investigation into the demographics of the different districts of Copenhagen and their respective voting behaviour
      over the last 10 years.</i>
    <strong class="date">14th of May, 2018</strong>
  </div>
  <div class="header">
    <div class="col-md-4 tabs">
      <button onclick="show('data')" class="tab selected" id="data-button">Data Story</button>
      <button onclick="show('explainer')" class="tab" id="explainer-button">Expainer Page</button>
    </div>
    <div class="col-md-8 no-tabs">

    </div>

  </div>
  <div class="container" id="explainer" style="display: none">
    <h3>Explainer Page</h3>
  </div>
  <div class="container" id="data">
    <h3>The Data Story</h3>
    <p class="button-row">
      <div class="col-md-4">
        <p>
          Select a metric to explore
        </p>
        <p>
          <select onchange="update(this, 'map')" class="btn btn-default metric">
            <option selected value="no_inhabitants">Number of inhabitants</option>
            <option value="avg_income">Average income (DKK/y)</option>
            <option value="avg_age">Average age</option>
            <option value="no_apartments">Number of apartments</option>
            <option value="no_companies">Number of companies</option>
            <option value="no_netto_movings">Number of movings</option>
          </select>
        </p>
    </p>
    </div>
    <div class="col-md-8">
      <p>
        Select a year
      </p>
      <div class="slidecontainer">
        <input onchange="updateYear(this, 'map')" type="range" list="tickmarks" min="2008" max="2014" value="2008" class="slider" id="years">
        <datalist class="slider-ticks" id="tickmarks">
          <option value="2008" label="2008">
          <option value="2009" label="2009">
          <option value="2010" label="2010">
          <option value="2011" label="2011">
          <option value="2012" label="2012">
          <option value="2013" label="2013">
          <option value="2014" label="2014">
        </datalist>
      </div>
    </div>

    <div class="map"></div>
  </div>
  <div id="main" class="container">
    <p class="button-row">
      <div class="col-md-4">
        <p>
          Select a metric to explore
        </p>
        <p>
          <select onchange="update(this, 'wheel')" class="btn btn-default metric">
              <option selected value="no_inhabitants">Number of inhabitants</option>
              <option value="avg_income">Average income (DKK/y)</option>
              <option value="avg_age">Average age</option>
              <option value="no_apartments">Number of apartments</option>
              <option value="no_companies">Number of companies</option>
              <option value="no_netto_movings">Number of movings</option>
            </select>
        </p>
    </p>
    </div>
    <div class="col-md-8">
      <p>
        Select a year
      </p>
      <div class="slidecontainer">
        <input onchange="updateYear(this, 'wheel')" type="range" list="tickmarks" min="2008" max="2014" value="2008" class="slider" id="years">
        <datalist class="slider-ticks" id="tickmarks">
            <option value="2008" label="2008">
            <option value="2009" label="2009">
            <option value="2010" label="2010">
            <option value="2011" label="2011">
            <option value="2012" label="2012">
            <option value="2013" label="2013">
            <option value="2014" label="2014">
          </datalist>
      </div>
    </div>
    <select onchange="aptUpdate(this)" class="btn btn-default metric" id="apartmentDropDown">
        <option selected value="apt_size">Apartment Size</option>
        <option value="apt_age">Apartment Age</option>
        <option value="apt_type">Apartment Type</option>
      </select>
    <div class="sequence"></div>
    <div class="chart">
      <div class="explanation" style="visibility: hidden;">
        <span class="percentage"></span><br/>
      </div>
    </div>
    <div id="sidebar">
      <input type="checkbox" id="togglelegend"><label>Legend</label><br/>
      <div id="legend" style="visibility: hidden;"></div>
    </div>
    <i class="barChartTitle"> </i>
    <div class="barChart"></div>
  </div>


  <script type="text/javascript" src="sequences.js"></script>
  <script type="text/javascript" src="scripts/map.js"></script>
  <script type "text/javascript">
    var updateYear = function(obj, viz) {
      console.log('updating year', obj.value, viz);

      setYear(obj.value, viz);
      if (viz === 'wheel') {
        d3.selectAll(".pieSVG").remove();
        d3.selectAll(".barSVG").remove();
        updateCoolPieChart(getYear(viz), getMetric(viz));
      }
      if (viz === 'map') {
        filterData()
        setColorDomain();
        drawMap();
      }
    }

    var show = function(tag) {
      if (tag === 'data') {
        document.getElementById('data').style.display = 'block';
        document.getElementById('explainer').style.display = 'none';
        document.getElementById('data-button').classList.add("selected");
        document.getElementById('explainer-button').classList.remove("selected");

      }
      if (tag === 'explainer') {
        document.getElementById('data').style.display = 'none';
        document.getElementById('explainer').style.display = 'block';
        document.getElementById('explainer-button').classList.add("selected");
        document.getElementById('data-button').classList.remove("selected");
      }
    }


    var aptUpdate = function(obj) {
      d3.selectAll(".pieSVG").remove()
      d3.selectAll(".barSVG").remove()
      updateAptCoolPieChart(getYear('wheel'), obj.value)
    }

    var update = function(obj, viz) {
      console.log('updating metric', obj.value, viz);
      d3.selectAll(".pieSVG").remove();
      d3.selectAll(".barSVG").remove();

      setMetric(obj.value, viz);
      if (viz === 'map') {
        filterData();
        setColorDomain();
        drawMap();
      }
      if (viz === 'wheel') {
        updateCoolPieChart(getYear(viz), getMetric(viz));
      }
    }

    updateCoolPieChart(getYear('wheel'), getMetric('wheel'));
  </script>

</body>

</html>